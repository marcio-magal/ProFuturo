{% extends 'base.html' %}

{% block main %}

    <h1>{{ playlist.name }}</h1>

    <!-- Video Player -->
    <iframe id="video-player"
            width="560"
            height="315"
            src="https://www.youtube.com/embed/{{ selected_video.youtube_id }}"
            title="YouTube video player"
            frameborder="0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
            referrerpolicy="strict-origin-when-cross-origin"
            allowfullscreen>
    </iframe>

    <!-- Like Button -->
    <div>
        <button id="like-button" data-video-id="{{ selected_video.id }}">Curtir</button>
        <span id="like-count">{{ selected_video.likes }}</span> Curtidas
    </div>

    <!-- Comments Section -->
    <div>
        <h3>Comentários</h3>
        <ul id="comment-list">
            {% for comment in selected_video.comments.all %}
                <li data-comment-id="{{ comment.id }}">
                    <strong>{{ comment.user.username }}</strong>: <span class="comment-text">{{ comment.text }}</span>
                    {% if comment.user == request.user %}
                        <button class="edit-comment">Editar</button>
                        <button class="delete-comment">Excluir</button>
                    {% endif %}
                </li>
            {% empty %}
                <p>Não há comentários ainda.</p>
            {% endfor %}
        </ul>
        <textarea id="new-comment-text" placeholder="Adicionar um comentário..."></textarea>
        <button id="add-comment-button">Comentar</button>
    </div>

    <!-- Video List (Below Comments) -->
    <h3>Vídeos da Playlist</h3>
    <ul id="video-list">
        {% for video in videos %}
            <li>
                <a href="#" class="video-link" data-video-id="{{ video.youtube_id }}" data-video-db-id="{{ video.id }}">
                    {{ video.title }}
                </a>
            </li>
        {% empty %}
            <p>Não há vídeos nesta playlist.</p>
        {% endfor %}
    </ul>
{% endblock %}
